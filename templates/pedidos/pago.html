{% extends "base.html" %}

{% block content %}

<!-- AGREGADO: Estilos para forzar el color claro en los placeholders -->
<style>
    /* Esto hace que el texto de "ejemplo" (placeholder) sea gris claro y legible */
    .form-control::placeholder {
        color: #cfcfcf !important; /* Gris muy claro, casi blanco */
        opacity: 1; /* Importante para que Firefox no lo haga transparente */
    }
    
    /* Asegura que cuando el usuario escriba, la letra sea blanca pura */
    .form-control {
        color: #ffffff !important;
        background-color: #2c2c2c !important;
        border: 1px solid #555 !important;
    }

    .form-control:focus {
        background-color: #333 !important;
        border-color: #3b82f6 !important; /* Azul al hacer click */
        box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.25) !important;
    }
</style>

<div class="row justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="col-md-5">
        
        <!-- Tarjeta de Resumen -->
        <div class="card bg-dark text-white shadow-lg border-secondary mb-3">
            <div class="card-header border-secondary bg-transparent d-flex justify-content-between align-items-center">
                <h5 class="mb-0 text-white fw-bold">Resumen del Pedido #{{ pedido.id }}</h5>
                <span class="badge bg-warning text-dark">Pendiente de Pago</span>
            </div>
            <div class="card-body">
                <h1 class="display-4 text-center fw-bold text-success">
                    ${{ "%.2f"|format(pedido.total) }}
                </h1>
                <p class="text-center text-white mb-0">Total a pagar</p>
            </div>
        </div>

        <!-- Formulario de Tarjeta -->
        <div class="card shadow-lg" style="background-color: #1e1e1e; border: 1px solid #444;">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4 class="mb-0 text-white"><i class="bi bi-credit-card-2-front me-2"></i> Detalles de Pago</h4>
                    <div class="d-flex gap-2">
                        <i class="bi bi-alipay text-white fs-4"></i>
                        <i class="bi bi-paypal text-white fs-4"></i>
                        <i class="bi bi-credit-card text-white fs-4"></i>
                    </div>
                </div>

                <form action="{{ url_for('pedidos.procesar_pago', pedido_id=pedido.id) }}" method="POST" id="payment-form">
                    
                    <div class="mb-3">
                        <label class="form-label text-white text-uppercase fw-bold" style="font-size: 0.85rem;">Titular de la tarjeta</label>
                        <input type="text" 
                               class="form-control form-control-lg" 
                               placeholder="Como aparece en la tarjeta" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label text-white text-uppercase fw-bold" style="font-size: 0.85rem;">NÃºmero de tarjeta</label>
                        <div class="input-group">
                            <span class="input-group-text text-white" style="background-color: #2c2c2c; border: 1px solid #555;"><i class="bi bi-credit-card"></i></span>
                            <input type="text" 
                                   name="tarjeta_numero" 
                                   class="form-control form-control-lg" 
                                   placeholder="0000 0000 0000 0000" maxlength="19" required>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-6">
                            <div class="mb-3">
                                <label class="form-label text-white text-uppercase fw-bold" style="font-size: 0.85rem;">Vencimiento</label>
                                <input type="text" 
                                       class="form-control" 
                                       placeholder="MM/AA" maxlength="5" required>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="mb-3">
                                <label class="form-label text-white text-uppercase fw-bold" style="font-size: 0.85rem;">CVV</label>
                                <input type="password" 
                                       class="form-control" 
                                       placeholder="123" maxlength="3" required>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg fw-bold shadow-sm" id="btn-pagar">
                            <i class="bi bi-lock-fill me-2"></i> Pagar ${{ "%.2f"|format(pedido.total) }}
                        </button>
                        <a href="{{ url_for('carrito.ver_carrito') }}" class="btn btn-outline-light btn-sm">Cancelar y volver</a>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="text-center mt-3">
            <small class="text-white"><i class="bi bi-shield-lock"></i> Pagos encriptados y seguros 256-bit SSL</small>
        </div>

    </div>
</div>

<script>
    document.getElementById('payment-form').addEventListener('submit', function() {
        const btn = document.getElementById('btn-pagar');
        btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span> Procesando...';
        btn.disabled = true;
    });
</script>
{% endblock %}